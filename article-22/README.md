# Demo code for Article 22

This directory contains demo code for DelphiDabbler's article "[How to call Delphi code from scripts running in a TWebBrowser](https://delphidabbler.com/articles/article-22)".

The demo was not originally developed under version control. It's last update before being placed under version control was on 1 February 2006. The code was added to the [`delphidabbler/article-demos`](https://github.com/delphidabbler/article-demos) GitHub repository on 24 April 2022. See [CHANGELOG.md](./CHANGELOG.md) for details of known updates.

## About the Demo

The demo includes the following files:

* `Article22.dat` – data file used by demo program.
* `Article22.dpr` – project file for demo program.
* `Article22.html` – HTML document displayed in _TWebBrowser_ control.
* `Article22.res` – icon etc for demo program.
* `Article22.tlb` – type library used to define external object interface.
* `Article22_TLB.pas` – file generated by type library editor.
* `FmDemo.pas/.dfm` – demo program's main form.
* `IntfDocHostUIHandler.pas` – defines _IDocHostUIHandler_ interface and associated structures.
* `UExternalContainer.pas` – defines _IDocHostUIHandler_ and _IOleClientSite_ implementation that provides external object to _TWebBrowser_.
* `UMyExternal.pas` – implementation of external object.
* `UNulContainer.pas` – defines do nothing implementation of _IDocHostUIHandler_ and _IOleClientSite_ and registers client site with _TWebBrowser_.

To use the demo start Delphi and load `Article22.dpr`. Compile the program and run it. `Article22.html` is displayed in the browser control. Click on one of the program names displayed in the list and its name and precis will appear in the bordered box at the bottom of the display.

Once the program has been tested, examine the code in the various units.

The code has been tested on Windows 11 with Delphi XE and Delphi 11.0 Alexandria. When compiled with Delphi 11.0, both 32 bit and 64 bit targets have been tested to compile and run correctly.

> It is probable, but not guaranteed, that the code will work with compilers back to Delphi 7, but this has not been tested using the latest version.

## Bug Reports

If you find a bug in the demo code, please report it. See the [main read-me file](https://github.com/delphidabbler/article-demos/blob/master/README.md#bug-reports) for information on how to do so.

> **Note:** Any bug that relates to compilation with a compiler earlier than Delphi XE will not be fixed, unless you can provide such a fix.
